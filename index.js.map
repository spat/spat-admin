{"version":3,"sources":["main.js","tags/admin-field.pug","tags/admin-item.pug","tags/admin-modal-array.pug","tags/admin-module-form.pug","tags/admin-modal-collection.pug","tags/admin-module-header.pug","tags/admin-module-list.pug","tags/admin-module-menu.pug","tags/admin-page.pug"],"names":["admin","utils","obj","key","split","reduce","t","v","value","i","arr","length","riot","require","tag2","opts","getValue","refs","input","Array","isArray","riotValue","map","s","trim","on","ondragover","e","ondrop","preventDefault","spat","modal","indicator","files","from","dataTransfer","promises","file","url","app","uploadFile","urls","Promise","all","images_text","join","insertText","close","onInsertText","shortcode","item","onclick","text","shortcodes","focus","selectedValue","substring","selectionStart","selectionEnd","prefix","postfix","cursorPosition","before","substr","after","Number","$","datetimepicker","format","field","options","dayjs","update","datetime","valueOf","choices","checked","toggle","document","createElement","type","accept","onchange","currentTarget","_setFile","root","validateFileImageOnly","alert","onSelectImage","click","URL","createObjectURL","test","re","delete","stopPropagation","isDeletable","deletable","undefined","list","setup","path","items","isReadOnly","Sortable","create","animation","handle","onEnd","temp","splice","oldIndex","newIndex","onAdd","push","onDeleteItem","index","fields","results","readonly","crud","get","collection","onOpenModal","open","waitClose","getItemValue","$get","value_key","getItemLabel","label_key","onClick","tag","data","$set","heading","mappings","result","onCancel","visible","id","basename","dirname","pop","reset","schema_path","filter","schema","submit","btn","onSubmit","save","post","trigger","oncreate","router","replace","put","toast","message","del","confirm","isVisibleField","syncCandidates","keyword","search","filters","res","candidates","onSearch","onSelect","getBreadcrumbs","label","link","form","includes","paths","menu","some","isLast","onDelete","canCreate","canUpdate","canDelete","fetch","next_cursor","getList","Object","assign","filters_tag","forEach","cursor","signOut","firebase","auth","slice","pathes"],"mappings":"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","file":"index.js","sourceRoot":"src","sourcesContent":["// import './tags/admin-field.pug';\n// import './tags/admin-item.pug';\n// import './tags/admin-page.pug';\n\nimport './tags/**/*.pug';\n\nvar admin = {\n  utils: {\n    '$get': (obj, key) => {\n      return key.split('.').reduce(function (t, v) {\n        return t && t[v];\n      }, obj);\n    },\n    '$set': (obj, key, value) => {\n      key.split('.').reduce(function (t, v, i, arr) {\n        if (i === (arr.length - 1)) {\n          t[v] = value;\n        }\n        else {\n          if (!t[v]) t[v] = {};\n          return t[v];\n        }\n      }, obj);\n    },\n  },\n};\n\nexport default admin;\n","const riot = require('riot');\n\nriot.tag2('admin-field-text', '<div class=\"fs11 bold text-gray mb8\" if=\"{opts.field.label}\">{opts.field.label}</div> <input class=\"input w-full {&quot;bg-whitesmoke border-transparent&quot;: opts.field.options.readonly}\" ref=\"input\" type=\"text\" riot-value=\"{opts.riotValue.toString()}\" required=\"{opts.field.options.required}\" readonly=\"{opts.field.options.readonly}\">', 'admin-field-text,[data-is=\"admin-field-text\"]{display:block}', '', function(opts) {\n    this.getValue = () => {\n      var value = this.refs.input.value;\n      if (Array.isArray(this.opts.riotValue)) {\n        return value.split(',').map(s => s.trim());\n      }\n      else {\n        return value;\n      }\n\n    };\n\n});\nriot.tag2('admin-field-textarea', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <div> <div class=\"border-top border-right border-left p8\" if=\"{opts.field.options.shortcode}\"> <button class=\"px8 py6 button mr4\" type=\"button\" each=\"{shortcode in app.admin.shortcodes.list}\" onclick=\"{onInsertText}\">{shortcode.label}</button> </div> <textarea class=\"input w-full lh15 {&quot;bg-whitesmoke border-transparent&quot;: opts.field.options.readonly}\" ref=\"input\" rows=\"{opts.field.rows || 4}\" readonly=\"{opts.field.options.readonly}\">{opts.riotValue}</textarea> </div>', 'admin-field-textarea,[data-is=\"admin-field-textarea\"]{display:block}', '', function(opts) {\n    this.on('mount', () => {\n      this.refs.input.ondragover = (e) => { return false; };\n      this.refs.input.ondrop = async (e) => {\n        e.preventDefault();\n\n        var i = spat.modal.indicator();\n\n        var files = Array.from(e.dataTransfer.files);\n        var promises = files.map(async file => {\n          let url = await app.admin.utils.uploadFile(file);\n\n          url += '?auto=format';\n\n          return url;\n        });\n        var urls = await Promise.all(promises);\n\n        var images_text = urls.map(url => `![](${url})`).join('\\n');\n\n        this.insertText(images_text);\n\n        i.close();\n      };\n    });\n\n    this.onInsertText = async (e) => {\n      var shortcode = e.item.shortcode;\n      var onclick = shortcode.onclick;\n      var text = '';\n\n      if (onclick) {\n\n        if (typeof onclick === 'string') {\n          onclick = app.admin.shortcodes[onclick];\n        }\n        text = await onclick();\n      }\n      else {\n        var input = this.refs.input;\n        input.focus();\n\n        var selectedValue = input.value.substring(input.selectionStart, input.selectionEnd);\n        text = shortcode.prefix + selectedValue + shortcode.postfix;\n      }\n\n      if (text) {\n        this.insertText(text);\n      }\n    };\n\n    this.insertText = (text) => {\n      let input = this.refs.input;\n      let cursorPosition = input.selectionStart;\n\n      let before = input.value.substr(0, cursorPosition);\n      let after = input.value.substr(input.selectionEnd);\n\n      input.value = before + text + after;\n\n      input.selectionStart = input.selectionEnd = cursorPosition + text.length;\n    };\n\n    this.getValue = () => {\n      return this.refs.input.value;\n    };\n\n});\nriot.tag2('admin-field-number', '<div class=\"fs11 bold text-gray mb8\" if=\"{opts.field.label}\">{opts.field.label}</div> <input class=\"input w-full {&quot;bg-whitesmoke border-transparent&quot;: opts.field.options.readonly}\" ref=\"input\" step=\"{opts.field.options.step}\" min=\"{opts.field.options.min}\" max=\"{opts.field.options.max}\" riot-value=\"{opts.riotValue}\" required=\"{opts.field.options.required}\" readonly=\"{opts.field.options.readonly}\" type=\"{\\'number\\'}\">', 'admin-field-number,[data-is=\"admin-field-number\"]{display:block}', '', function(opts) {\n    this.getValue = () => {\n      return Number(this.refs.input.value);\n    };\n\n});\nriot.tag2('admin-field-date', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <input class=\"input w-full {&quot;bg-whitesmoke border-transparent pointer-none&quot;: opts.field.options.readonly}\" ref=\"datetimepicker\" required=\"{opts.field.options.required}\" placeholder=\"{opts.field.options.placeholder}\" readonly=\"{opts.field.options.readonly}\" tabindex=\"{opts.field.options.readonly ? -1 : 0}\">', 'admin-field-date,[data-is=\"admin-field-date\"]{display:block}', '', function(opts) {\n    this.on('mount', () => {\n      $(this.refs.datetimepicker).datetimepicker({});\n\n      if (this.opts.riotValue) {\n        var format = opts.field.options && opts.field.options.format || 'YYYY/MM/DD HH:mm';\n        this.refs.datetimepicker.value = dayjs(this.opts.riotValue).format(format);\n      }\n\n      this.update();\n    });\n\n    this.getValue = () => {\n      var datetime = dayjs(this.refs.datetimepicker.value.valueOf());\n\n      return +datetime || 0;\n    };\n\n});\n\nriot.tag2('admin-field-markdown', '<div>markdown</div>', 'admin-field-markdown,[data-is=\"admin-field-markdown\"]{display:block}', '', function(opts) {\n});\nriot.tag2('admin-field-select', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <select class=\"select px16 py12 pr40\" ref=\"input\" required=\"{opts.field.options.required}\"> <option each=\"{choice in choices}\" riot-value=\"{choice.value}\">{choice.label || choice.value}</option> </select>', 'admin-field-select,[data-is=\"admin-field-select\"]{display:block}', '', function(opts) {\n    this.on('mount', async () => {\n      var choices = opts.field.options.choices;\n      if (typeof choices === 'function') {\n        choices = choices();\n        if (choices instanceof Promise) {\n          choices = await choices;\n        }\n      }\n      this.update({choices});\n\n      this.refs.input.value = this.opts.riotValue;\n    });\n    this.getValue = () => {\n      return this.refs.input.value;\n    };\n\n});\nriot.tag2('admin-field-switch', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <div class=\"relative switch cursor-pointer s-full rounded-full transition f fm border {&quot;bg-primary checked&quot;: checked}\" onclick=\"{toggle}\"> <div class=\"inner-button flex-fixed relative ml3\"></div> </div>', 'admin-field-switch,[data-is=\"admin-field-switch\"]{display:block} admin-field-switch .switch,[data-is=\"admin-field-switch\"] .switch{width:50px;height:27px;cursor:pointer;-webkit-user-select:none;user-select:none;border-width:1px} admin-field-switch .switch.checked .inner-button,[data-is=\"admin-field-switch\"] .switch.checked .inner-button{transform:translateX(23px)} admin-field-switch .inner-button,[data-is=\"admin-field-switch\"] .inner-button{width:20px;height:20px;transform:translateX(-1px);background-color:lightgray;border-radius:50%;transition:256ms}', '', function(opts) {\n    this.on('mount', () => {\n      this.checked = this.opts.riotValue;\n      this.update();\n    });\n\n    this.getValue = () => {\n      return this.checked;\n    };\n\n    this.toggle = (e) => {\n      this.checked = !this.checked;\n    };\n\n});\nriot.tag2('admin-field-image', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <div class=\"relative f fh bg-gray_pale w-full h-auto max-width-500 min-height-200 cursor-pointer mb4\" onclick=\"{onSelectImage}\"><img class=\"s-full object-fit-contain border\" if=\"{url}\" riot-src=\"{url}\"> <div class=\"absolute trbl0 s-full f fh fs26\">+</div> <div class=\"absolute tn16 rn16 bg-gray_pale f fh circle s32 border\" if=\"{isDeletable()}\" onclick=\"{delete}\"> <div class=\"f fh s-full pb4 fs20\">×</div> </div> </div> <div class=\"fs10 mb16\" if=\"{!opts.field.options}\">クリック または ドラッグ&ドロップで追加できます</div>', 'admin-field-image,[data-is=\"admin-field-image\"]{display:block} admin-field-image .max-width-500,[data-is=\"admin-field-image\"] .max-width-500{max-width:500px} admin-field-image .min-height-200,[data-is=\"admin-field-image\"] .min-height-200{min-height:200px}', '', function(opts) {\n    this.on('mount', () => {\n      this.url = this.opts.riotValue;\n      this.update();\n\n      this.input = document.createElement('input');\n      this.input.type = 'file';\n      this.input.accept = 'image/*';\n\n      this.input.onchange = async (e) => {\n        var file = e.currentTarget.files[0];\n        if (!file) return ;\n        this._setFile(file);\n        this.update();\n      };\n\n      this.root.ondragover = (e) => { return false; };\n      this.root.ondrop = (e) => {\n        var file = e.dataTransfer.files[0];\n        if (!file) return ;\n\n        if (!this.validateFileImageOnly(file.type)) {\n          e.preventDefault();\n          spat.modal.alert('その形式のファイルは登録できません。');\n          return;\n        }\n\n        this._setFile(file);\n        return false;\n      };\n    });\n\n    this.onSelectImage = async (e) => {\n      e.preventDefault();\n\n      if (this.opts.field.options && typeof this.opts.field.options.onclick === 'function') {\n        var url = await this.opts.field.options.onclick();\n        if (url) {\n          this.url = url;\n          this.update();\n        }\n      }\n      else {\n        this.input.click();\n      }\n    };\n\n    this._setFile = async (file) => {\n      this.file = file;\n      this.url = URL.createObjectURL(file);\n      this.update();\n    };\n\n    this.getValue = async () => {\n\n      if (!this.file) {\n\n        if (this.url === this.opts.riotValue) {\n          return this.opts.riotValue;\n        }\n\n        if (/^http.+/.test(this.url)) {\n          return this.url;\n        }\n\n        if (!this.url) {\n          return \"\";\n        }\n      }\n\n      let url = await app.admin.utils.uploadFile(this.file);\n\n      return url;\n    };\n\n    this.validateFileImageOnly = (type) => {\n      var re = /(^image\\/\\w*)/;\n      return re.test(type);\n    };\n\n    this.delete = (e) => {\n      e.stopPropagation();\n      delete this.file;\n      this.url = '';\n      this.update();\n    };\n\n    this.isDeletable = () => {\n      var deletable = true;\n      if (this.opts.field.options && this.opts.field.options.deletable !== undefined) {\n        deletable = this.opts.field.options.deletable;\n      }\n      return deletable && this.url || this.file;\n    };\n\n});\nriot.tag2('admin-field-list', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <div class=\"border\"> <div ref=\"list\" data-is=\"admin-module-list\"></div> </div>', '', '', function(opts) {\n    this.on('mount', () => {\n      this.refs.list.setup({\n        path: `${this.opts.item.path}/${this.opts.field.key}`,\n      });\n    });\n\n});\nriot.tag2('admin-field-array', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <div class=\"mb8\" ref=\"items\"> <div class=\"p8 border rounded-4 mb8\" each=\"{item, index in items}\"> <div class=\"f fm\"> <div if=\"{!isReadOnly()}\"><i class=\"material-icons mr4 handle cursor-grab\">import_export</i></div> <div><span class=\"mr8\">{index}.</span></div> <div class=\"w-full mr8\" ref=\"fields\" data-is=\"admin-field-{opts.field.options.field.type}\" field=\"{opts.field.options.field}\" riot-value=\"{item}\"></div> <button if=\"{!isReadOnly()}\" type=\"button\" onclick=\"{onDeleteItem}\"><i class=\"material-icons text-gray fs18\">delete</i></button> </div> </div> </div> <div if=\"{!isReadOnly()}\"> <button class=\"button\" type=\"button\" onclick=\"{onAdd}\">追加</button> </div>', 'admin-field-array,[data-is=\"admin-field-array\"]{display:block} admin-field-array .cursor-grab,[data-is=\"admin-field-array\"] .cursor-grab{cursor:grab}', '', function(opts) {\n    this.on('mount', async () => {\n      this.items = this.opts.riotValue || [];\n      this.update();\n\n      if (!this.isReadOnly()) {\n\n        Sortable.create(this.refs.items, {\n          animation: 150,\n          handle: '.handle',\n          onEnd: async (e) => {\n            var items = await this.getValue();\n            var temp = items.splice(e.oldIndex, 1)[0];\n            items.splice(e.newIndex, 0, temp);\n\n            this.items = [];\n            this.update();\n\n            this.items = items;\n            this.update();\n          },\n        });\n      }\n    });\n\n    this.onAdd = async () => {\n      this.items.push('');\n      this.update();\n    };\n\n    this.onDeleteItem = async (e) => {\n      var items = await this.getValue();\n      items.splice(e.item.index, 1);\n\n      this.items = [];\n      this.update();\n\n      this.items = items;\n      this.update();\n    };\n\n    this.getValue = async () => {\n\n      if (!this.refs.fields) return [];\n\n      var fields = Array.isArray(this.refs.fields) ? this.refs.fields : [this.refs.fields];\n\n      var promises = fields.map(async field => {\n        return field.getValue();\n      });\n\n      var results = await Promise.all(promises);\n\n      return results;\n    };\n\n    this.isReadOnly = () => {\n      return this.opts.field.options ? this.opts.field.options.readonly : false;\n    };\n\n});\nriot.tag2('admin-field-collection', '<div class=\"fs11 bold text-gray mb8\" if=\"{opts.field.label}\">{opts.field.label}</div> <div class=\"f fm w-full\"> <div class=\"f fm w-full p8 border rounded-4 mr8\" if=\"{item}\"> <div class=\"w-full\">{getItemLabel(item)}</div> <button type=\"button\" onclick=\"{onDeleteItem}\"><i class=\"material-icons text-gray fs18\">delete</i></button> </div> <div class=\"flex-fixed\"> <button class=\"button\" type=\"button\" onclick=\"{onOpenModal}\">設定</button> </div> </div>', 'admin-field-collection,[data-is=\"admin-field-collection\"]{display:block} admin-field-collection .cursor-grab,[data-is=\"admin-field-collection\"] .cursor-grab{cursor:grab}', '', function(opts) {\n    this.on('mount', async () => {\n      this.item = null;\n      if (this.opts.riotValue) {\n        var item = await app.admin.crud.get({\n          path: `${this.opts.field.options.collection}/${this.opts.riotValue}`\n        });\n\n        this.item = item;\n      }\n      this.update();\n    });\n\n    this.onOpenModal = async () => {\n      var modal = spat.modal.open('admin-modal-collection', {\n        options: this.opts.field.options,\n      });\n\n      var item = await modal.waitClose();\n\n      if (item) {\n        this.item = item;\n        riot.update();\n      }\n    };\n\n    this.getItemValue = (item) => {\n      return admin.utils.$get(item, this.opts.field.options.value_key);\n    };\n    this.getItemLabel = (item) => {\n      return admin.utils.$get(item, this.opts.field.options.label_key);\n    };\n\n    this.onDeleteItem = (e) => {\n      this.item = null;\n      this.update();\n    };\n\n    this.getValue = () => {\n      return this.item ? this.getItemValue(this.item) : '';\n    };\n\n});\nriot.tag2('admin-field-button', '<button class=\"button\" type=\"button\" onclick=\"{onClick}\">{this.opts.field.label}</button>', 'admin-field-button,[data-is=\"admin-field-button\"]{display:block} admin-field-button .cursor-grab,[data-is=\"admin-field-button\"] .cursor-grab{cursor:grab}', '', function(opts) {\n    this.onClick = (e) => {\n      let onclick = this.opts.field.options.onclick;\n\n      if (onclick) {\n        onclick({\n          tag: this,\n          field: this.opts.field,\n          item: this.opts.item,\n          value: this.opts.riotValue,\n        });\n      }\n    };\n\n});\nriot.tag2('admin-field-object', '<div class=\"fs11 bold text-gray mb8\">{opts.field.label}</div> <div> <div class=\"mb8\" each=\"{field, index in opts.field.options.fields}\"> <div class=\"w-full mb8\" ref=\"fields\" data-is=\"admin-field-{field.type}\" field=\"{field}\" riot-value=\"{admin.utils.$get(opts.riotValue, field.key)}\"></div> </div> </div>', 'admin-field-object,[data-is=\"admin-field-object\"]{display:block}', '', function(opts) {\n    this.on('mount', async () => {\n    });\n\n    this.getValue = async () => {\n      var data = {};\n      var fields = Array.isArray(this.refs.fields) ? this.refs.fields : [this.refs.fields];\n\n      var promises = fields.map(async field => {\n        if (!field.getValue) return ;\n\n        var value = field.getValue();\n\n        if (value instanceof Promise) {\n          value = await value;\n        }\n\n        admin.utils.$set(data, field.opts.field.key, value);\n      });\n\n      await Promise.all(promises);\n\n      return data;\n    };\n});","const riot = require('riot');\n\nriot.tag2('admin-item-text', '<p class=\"line-clamp-1\">{text || opts.riotValue}</p>', 'admin-item-text,[data-is=\"admin-item-text\"]{display:block}', '', function(opts) {\n    this.on('mount', async () => {\n      let options = this.opts.heading.options;\n      if (options) {\n\n        let mappings = options.mappings;\n        if (mappings && mappings[opts.riotValue]) {\n          this.text = mappings[opts.riotValue];\n          this.update();\n        }\n\n        let getValue = options.getValue;\n        if (getValue) {\n          let result = getValue({\n            tag: this,\n            value: this.opts.riotValue,\n            item: this.opts.item,\n          });\n\n          if (result instanceof Promise) {\n            result = await result;\n          }\n\n          this.text = result;\n          this.update();\n        }\n      }\n    });\n\n});\nriot.tag2('admin-item-date', '<p if=\"{!opts.riotValue}\">-</p> <p if=\"{opts.riotValue}\">{dayjs(opts.riotValue).format(\\'YYYY/MM/DD HH:mm\\')}</p>', 'admin-item-date,[data-is=\"admin-item-date\"]{display:block}', '', function(opts) {\n});\nriot.tag2('admin-item-image', '<div class=\"rect-ogp bg-whitesmoke border\"><img class=\"s-full object-fit-contain\" if=\"{opts.riotValue}\" riot-src=\"{opts.riotValue}\"></div>', 'admin-item-image,[data-is=\"admin-item-image\"]{display:block}', '', function(opts) {\n});","const riot = require('riot');\n\nriot.tag2('admin-modal-array', '<div class=\"f flex-column bg-white w80vw h80vh rounded-8\" ref=\"modal\"> <div class=\"f fh p16 overflow-scroll h-full bg-whitesmoke\"> <div> <input class=\"input w-full p4 mb8\" type=\"{this.opts.type}\" ref=\"input\" riot-value=\"{opts.item}\"> <div class=\"f fc\"> <button class=\"block text-center p8 border rounded-4 bg-white hover-trigger hover-bg-dark mr16\" type=\"button\" onclick=\"{onCancel}\">キャンセル</button> <button class=\"block text-center p8 border rounded-4 bg-white hover-trigger hover-bg-dark\" type=\"button\" onclick=\"{onAdd}\">追加</button> </div> </div> </div> </div>', 'admin-modal-array,[data-is=\"admin-modal-array\"]{background-color:rgba(0,0,0,0.5)}', 'class=\"f fh\"', function(opts) {\n    this.onAdd = (e) => {\n      this.value = this.refs.input.value;\n      this.close();\n    };\n\n    this.onCancel = (e) => {\n      this.value = false;\n      this.close();\n    };\n});","const riot = require('riot');\n\nriot.tag2('admin-module-form', '<form class=\"row mxn16\" id=\"form1\" if=\"{visible}\" ref=\"form\" onsubmit=\"{onSubmit}\"> <div class=\"mb32 s-w-full {form.class}\" each=\"{form in schema.forms}\"> <div class=\"box-shadow rounded-4 bg-white p32 mx16\"> <div class=\"mb16\"> <div class=\"fs18 bold mb8\">{form.label}</div> <div class=\"h2 w-full bg-primary\"></div> </div> <div class=\"row\"> <div class=\"block w-full mb32 {field.class}\" each=\"{field in form.fields}\" if=\"{isVisibleField(field)}\"> <div ref=\"fields\" data-is=\"admin-field-{field.type}\" field=\"{field}\" riot-value=\"{admin.utils.$get(item, field.key)}\" item=\"{item}\"></div> </div> </div> </div> </div> <button class=\"hide\" ref=\"btn\">submit</button> </form>', 'admin-module-form,[data-is=\"admin-module-form\"]{display:block}', '', function(opts) {\n    this.visible = true;\n\n    this.setup = async ({path}) => {\n\n      this.path = path;\n\n      this.id = app.utils.path.basename(path);\n\n      this.basename = app.utils.path.dirname(path);\n\n      this.collection = this.basename.split('/').pop();\n\n      this.reset();\n\n      if (this.id !== 'new') {\n        var item = await app.admin.crud.get({\n          path: path,\n        });\n\n        this.item = item;\n      }\n\n      var schema_path = path.split('/').filter((path, index) => { return index%2 === 0; } ).join('.');\n      var schema = admin.utils.$get(app.admin.schema, schema_path) || app.admin.schema[this.collection+'/'+this.id];\n      this.schema = schema;\n\n      this.update();\n    };\n\n    this.reset = () => {\n\n      this.update({visible: false});\n      this.update({visible: true});\n    };\n\n    this.submit = () => {\n      this.refs.btn.click();\n    };\n\n    this.onSubmit = (e) => {\n      e.preventDefault();\n\n      this.save();\n    };\n\n    this.save = async () => {\n      var data = {};\n\n      var fields = Array.isArray(this.refs.fields) ? this.refs.fields : [this.refs.fields];\n\n      var promises = fields.map(async field => {\n        if (!field.getValue) return ;\n\n        var value = field.getValue();\n\n        if (value instanceof Promise) {\n          value = await value;\n        }\n\n        admin.utils.$set(data, field.opts.field.key, value);\n      });\n\n      await Promise.all(promises);\n\n      if (!this.item) {\n        var item = await app.admin.crud.post({\n          path: this.collection,\n          data,\n        });\n\n        this.trigger('create', {\n          item,\n        });\n        this.opts.oncreate && this.opts.oncreate({\n          item,\n        });\n        spat.router.replace(`/${item.path}`);\n      }\n      else {\n        var item = await app.admin.crud.put({\n          path: this.path,\n          data,\n        });\n\n        this.item = item;\n        this.trigger('save', {\n          item,\n        });\n      }\n\n      this.update();\n\n      spat.toast.message('保存しました!');\n    };\n\n    this.del = async () => {\n      let result = await spat.modal.confirm('本当に削除しますか？');\n\n      if (!result) return ;\n\n      await app.admin.crud.del({\n        path: this.path,\n      });\n\n      spat.toast.message('削除しました!');\n\n      spat.router.replace(`/${this.collection}`);\n    };\n\n    this.isVisibleField = (field) => {\n      if (!field.options || typeof field.options.visible !== 'function') return true;\n      return field.options.visible({\n        item: this.item,\n        field,\n      });\n    };\n});","const riot = require('riot');\n\nriot.tag2('admin-modal-collection', '<div class=\"f flex-column bg-white w80vw h80vh rounded-8\" ref=\"modal\"> <form class=\"h80 f fr fm p16 border-bottom\" onsubmit=\"{onSearch}\"> <div class=\"f\"> <input class=\"input mr8\" ref=\"search\" type=\"search\" placeholder=\"Search\"> <button class=\"button\">検索</button> </div> </form> <div class=\"p16 overflow-scroll h-full bg-whitesmoke\"> <button class=\"block w-full text-left p8 border rounded-4 bg-white hover-trigger hover-bg-dark mb8\" type=\"button\" each=\"{item, index in candidates}\" riot-value=\"{getItemValue(item)}\" onclick=\"{onSelect}\">{index}. {getItemLabel(item)}</button> </div> </div>', 'admin-modal-collection,[data-is=\"admin-modal-collection\"]{background-color:rgba(0,0,0,0.5)}', 'class=\"f fh\"', function(opts) {\n    this.on('mount', () => {\n      this.syncCandidates();\n    });\n\n    this.syncCandidates = async () => {\n      var data = {\n        path: `${this.opts.options.collection}`,\n        keyword: this.refs.search.value,\n      };\n      if (this.opts.options.filters) {\n        data.filters = this.opts.options.filters;\n      }\n\n      var res = await app.admin.crud.index(data);\n      this.candidates = res.items;\n      this.update();\n    };\n\n    this.onSearch = (e) => {\n      e.preventDefault();\n      this.syncCandidates();\n    };\n\n    this.getItemValue = (item) => {\n      return admin.utils.$get(item, this.opts.options.value_key);\n    };\n    this.getItemLabel = (item) => {\n      return admin.utils.$get(item, this.opts.options.label_key);\n    };\n\n    this.onSelect = (e) => {\n      this.value = e.item.item;\n      this.close();\n    };\n});","const riot = require('riot');\n\nriot.tag2('admin-module-header', '<div class=\"bg-white box-shadow relative\"> <div class=\"h60 f fbw fm px16\"> <div class=\"f fm\"> <div class=\"f fm item\" each=\"{item in getBreadcrumbs()}\"><a class=\"fs16 bold\" if=\"{item.link}\" href=\"{item.link}\">{item.label}</a> <div class=\"fs16 bold text-gray\" if=\"{!item.link}\">{item.label}</div> <div class=\"text-gray arrow mx8\">></div> </div> </div> <div class=\"f fm\" if=\"{opts.list}\"> <div class=\"ml8\" if=\"{canCreate()}\"><a class=\"button primary\" href=\"/{opts.path}/new\">NEW</a></div> </div> <div class=\"f fm\" if=\"{opts.form}\"> <div class=\"ml8\" if=\"{canDelete()}\"> <button class=\"button danger py6\" type=\"button\" onclick=\"{onDelete}\"><i class=\"fs18 material-icons\">delete</i></button> </div> <div class=\"ml8\" if=\"{canUpdate()}\"> <button class=\"primary button\" onclick=\"{onSubmit}\">SAVE</button> </div> </div> </div> </div>', 'admin-module-header,[data-is=\"admin-module-header\"]{display:block} admin-module-header .item:last-child .arrow,[data-is=\"admin-module-header\"] .item:last-child .arrow{display:none}', '', function(opts) {\n    this.on('mount', () => {\n\n    });\n\n    this.getBreadcrumbs = () => {\n      let items = [\n        {\n          label: 'TOP',\n          link: '/',\n        },\n      ];\n\n      if (this.opts.list) {\n        items.push({\n          label: this.opts.list.schema.label,\n          link: `/${opts.path}`,\n        });\n      }\n\n      else if (this.opts.form) {\n\n        if (this.opts.form.basename.includes('/')) {\n          let paths = this.opts.form.basename.split('/');\n          var link = \"\"\n          var schema = app.admin.schema;\n\n          for (var i = 0; i <= paths.length - 2; i += 2) {\n\n            schema = schema[paths[i]]\n            var item = {label: schema.label}\n\n            if (app.admin.menu[0].items.some(item => item.link === `/${paths[i]}`)) {\n              link = `/${paths[i]}`\n              item.link = link\n              link += `/${paths[i+1]}`;\n            } else {\n              link += `/${paths[i]}/${paths[i+1]}`\n            }\n\n            items.push(item);\n\n            items.push({\n              label: `${paths[i+1]}`,\n              link: link\n            })\n          }\n\n          items.push({\n            label: this.opts.form.schema.label,\n          });\n        }\n\n        else {\n          items.push({\n            label: this.opts.form.schema.label,\n            link: `/${this.opts.form.collection}`,\n          });\n        }\n\n        items.push({\n          label: this.opts.form.id,\n          link: `/${this.opts.form.path}`,\n        });\n      }\n      return items;\n    };\n\n    this.isLast = (index) => {\n      return this.opts.items.length-1 <= index;\n    };\n\n    this.onSubmit = () => {\n      this.opts.form.submit();\n    };\n\n    this.onDelete = () => {\n      this.opts.form.del();\n    };\n\n    this.canCreate = () => {\n      return opts.list && opts.list.schema.crud && opts.list.schema.crud.create;\n    };\n\n    this.canUpdate = () => {\n      return opts.form && opts.form.schema.crud && opts.form.schema.crud.update;\n    };\n\n    this.canDelete = () => {\n      return opts.form && opts.form.schema.crud && opts.form.schema.crud.delete;\n    };\n});","const riot = require('riot');\n\nriot.tag2('admin-module-list', '<div class=\"h80 f fbw fm p16 border-bottom\" show=\"{schema.search !== false}\"> <div class=\"f fm\"> <div class=\"mr16\" ref=\"filters\" each=\"{filter in schema.filters}\" data-is=\"admin-module-list-filter_\" filter=\"{filter}\" onchange=\"{search}\"></div> </div> <form onsubmit=\"{onSearch}\"> <div class=\"f\"> <input class=\"input mr8\" ref=\"search\" type=\"search\" placeholder=\"Search\"> <button class=\"button\">検索</button> </div> </form> </div> <div class=\"overflow-x-scroll\"> <table class=\"w-full w-full border-spacing-0 border-collapse-collapse\"> <thead> <tr> <th class=\"border-bottom\" each=\"{heading in schema.headings}\" riot-style=\"min-width: {heading.width || &quot;100px&quot;}; width: {heading.width || &quot;100%&quot;}\"> <div class=\"w-full text-left fs11 text-gray px12 py16 bold\">{heading.label}</div> </th> </tr> </thead> <tbody> <tr class=\"border-bottom hover-trigger hover-bg-dark cursor-pointer\" each=\"{item in items}\" onclick=\"{onSelect}\"> <td class=\"p12\" each=\"{heading in schema.headings}\"> <div class=\"fs13\" data-is=\"admin-item-{heading.type}\" riot-value=\"{admin.utils.$get(item, heading.key)}\" heading=\"{heading}\"></div> </td> </tr> </tbody> </table> <div class=\"f fh py10\" if=\"{next_cursor}\"> <button class=\"button\" type=\"button\" onclick=\"{fetch}\">もっと見る</button> </div> </div>', 'admin-module-list,[data-is=\"admin-module-list\"]{display:block}', '', function(opts) {\n    this.setup = async ({path}) => {\n      this.reset();\n\n      var schema_path = path.split('/').filter((path, index) => { return index%2 === 0; } ).join('.');\n      var schema = admin.utils.$get(app.admin.schema, schema_path) || app.admin.schema[this.collection+'/'+this.id];\n      this.schema = schema;\n\n      this.path = path;\n\n      await this.fetch();\n    };\n\n    this.reset = () => {\n      this.items = [];\n      this.next_cursor = '';\n    };\n\n    this.getList = () => {\n      var list = Object.assign(app.admin);\n    };\n\n    this.onSelect = (e) => {\n\n      const root = opts.root || '/';\n\n      this.trigger('select', {\n        item: e.item.item,\n      });\n\n      spat.router.push(`${root}${e.item.item.path}`);\n    };\n\n    this.fetch = async () => {\n      var keyword = this.refs.search.value;\n      var filters = {};\n\n      if (this.refs.filters) {\n        var filters_tag = Array.isArray(this.refs.filters) ? this.refs.filters : [this.refs.filters];\n        filters_tag.forEach(tag => {\n          filters[tag.opts.filter.key] = tag.getValue();\n        });\n      }\n\n      var {items, next_cursor} = await app.admin.crud.index({\n        path: this.path,\n        cursor: this.next_cursor,\n        keyword,\n        filters,\n      });\n      this.items.push(...items);\n      this.next_cursor = next_cursor;\n      this.update();\n\n    };\n\n    this.search = () => {\n\n      this.reset();\n\n      this.fetch();\n    };\n\n    this.onSearch = (e) => {\n      e.preventDefault();\n      this.search();\n    };\n\n});\nriot.tag2('admin-module-list-filter_', '<div class=\"text-center\"> <div class=\"fs11 bold mb4\">{opts.filter.label}</div> <select class=\"px8 py8 border rounded-4\" ref=\"filter\" onchange=\"{opts.onchange}\"> <option value=\"----\">----</option> <option each=\"{option in options}\" riot-value=\"{option.value}\">{option.label}</option> </select> </div>', 'admin-module-list-filter_,[data-is=\"admin-module-list-filter_\"]{display:block}', '', function(opts) {\n    this.on('mount', async () => {\n      let options = opts.filter.options;\n\n      if (typeof options === 'function') {\n        options = options();\n\n        if (options instanceof Promise) {\n          options = await options;\n        }\n      }\n\n      this.update({\n        options,\n      });\n    });\n\n    this.getValue = () => {\n      return this.refs.filter.value !== '----' ? this.refs.filter.value : '';\n    };\n});","const riot = require('riot');\n\nriot.tag2('admin-module-menu', '<div class=\"relative f fh fbw fclm p16 min-h100vh bg-primary text-white\"> <div> <div class=\"p16 f fh mb32\"><a href=\"/\"><img riot-src=\"{opts.logo}\"></a></div> <div class=\"mb32\" each=\"{section in opts.menu}\"> <div class=\"bold fs12 mb8\">{section.label}</div> <div> <div class=\"hover-trigger hover-bg-light rounded-8 pl8\" each=\"{item in section.items}\"><a class=\"p8 block {&quot;rounded-top-left-full rounded-bottom-left-full bg-whitesmoke pl16 bold text-gray mrn16 mln8&quot;: location.pathname.indexOf(item.link) === 0}\" href=\"{item.link}\">{item.label}</a></div> </div> </div> </div> <div class=\"f fh fclm mb32\"> <div class=\"mb16\">{firebase.auth().currentUser.email}</div> <button class=\"button fs12 p8\" onclick=\"{signOut}\">ログアウト</button> </div> </div>', 'admin-module-menu,[data-is=\"admin-module-menu\"]{display:block} admin-module-menu .min-h100vh,[data-is=\"admin-module-menu\"] .min-h100vh{min-height:100vh}', '', function(opts) {\n\n    this.signOut = async () => {\n      var result = await spat.modal.confirm('ログアウトしますか?');\n      if (!result) return;\n      firebase.auth().signOut();\n      spat.router.push('/login');\n    };\n});","const riot = require('riot');\n\nriot.tag2('admin-page', '<div class=\"s-full f fh\"> <div class=\"h-full w200 flex-fixed overflow-y-scroll s-hide\" data-is=\"admin-module-menu\" menu=\"{app.admin.menu}\" logo=\"{opts.logo || &quot;/images/logo_color.png&quot;}\"></div> <div class=\"s-full f flex-column overflow-hidden\"> <header data-is=\"admin-module-header\" path=\"{path}\" list=\"{refs.list}\" form=\"{refs.form}\"></header> <div class=\"p32 overflow-y-scroll s-p16\"> <div if=\"{type === &quot;list&quot;}\"> <div class=\"box-shadow rounded-4 bg-white\" ref=\"list\" data-is=\"admin-module-list\"></div> </div> <div if=\"{type === &quot;form&quot;}\"> <div ref=\"form\" data-is=\"admin-module-form\"></div> </div> <yield></yield> </div> </div> </div>', 'admin-page,[data-is=\"admin-page\"]{display:block}', 'class=\"s-full\"', function(opts) {\n    this.setup = async ({path}) => {\n\n      path = path[0] === '/' ? path.slice(1) : path;\n\n      if (!path) return ;\n\n      this.path = path;\n\n      let pathes = path.split('/');\n\n      if (pathes.length % 2 === 1) {\n        this.update({type:'list'});\n        await this.refs.list.setup({\n          path: path,\n        });\n        this.schema = this.refs.list.schema;\n      }\n\n      else {\n        this.update({type:'form'});\n        await this.refs.form.setup({\n          path: path,\n        });\n        this.schema = this.refs.form.schema;\n      }\n\n      this.update();\n    };\n\n    this.canCreate = () => {\n      return this.refs.list.schema.crud && this.refs.list.schema.crud.create;\n    };\n});"]}